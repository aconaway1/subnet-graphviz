This works but is ugly. I'll fix it later.